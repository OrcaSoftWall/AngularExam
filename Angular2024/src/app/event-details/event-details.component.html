<div class="sticky">
  <app-nav />
</div>

<div class="card" *ngIf="event; else loading">
  <h2>{{ event.title }}</h2>
  <div class="card-event">
    <div class="card-event-info">
      <p><strong>Date:</strong> {{ event.date | date : "fullDate" }}</p>
      <p><strong>Time:</strong> {{ event.time }} Hrs</p>
      <p><strong>Location:</strong> {{ event.location }}</p>
      <p><strong>Description:</strong> {{ event.description }}</p>

      <button *ngIf="eventId" (click)="navigateToEditEvent(eventId)">Edit</button>
      <button *ngIf="eventId" (click)="deleteEvent(eventId)">Delete</button>
    </div>



    <!-- If you're storing photoURLs and want to display an event image -->
    <img
      *ngIf="event.photoURL"
      [src]="event.photoURL"
      alt="Event Photo"
      class="event-photo"
    />
  </div>

  <!-- Comments Section -->
  <div class="comments-section">
    <h3>Comments</h3>
    <form (ngSubmit)="submitComment()">
      <textarea
        [(ngModel)]="commentText"
        name="comment"
        required
        placeholder="Write a comment..."
      ></textarea>
      <button type="submit">Post Comment</button>
    </form>

    <div class="comment" *ngFor="let comment of comments">
      <p>
        <strong>{{ comment.authorName }}:</strong> {{ comment.text }}
      </p>
      <small>{{ $any(comment).timestamp | date : "short" }}</small>

      <button
        *ngIf="comment.authorId === currentUserId"
        (click)="editComment(comment.id, comment.text)"
      >
        Edit
      </button>

      <button
        *ngIf="comment.authorId === currentUserId"
        (click)="deleteComment(comment.id)"
      >
        Delete
      </button>
    </div>
  </div>
</div>

<ng-template #loading>
  <p>Loading event details...</p>
</ng-template>
